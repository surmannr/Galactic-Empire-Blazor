@using GalacticEmpire.Shared.Dto.Empire
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@inherits LayoutComponentBase
@inject EmpireState State
@attribute [Authorize]
@inject IHttpClientFactory HttpClientFactory
@inject NavigationManager uriHelper

<AuthorizeView>
    <Authorized>
        <MudLayout>
            <MudAppBar Elevation="1" Style="background-color: rgba(0,0,0,0.7)">
                <MudIconButton  Variant="Variant.Filled" Icon="@Icons.Material.Filled.Menu" Size="Size.Large" Class="bg-light" Edge="Edge.Start" OnClick="@ToggleDrawerLeft" />
                <MudSpacer />
                <MudIconButton  Variant="Variant.Filled" Icon="@Icons.Material.Filled.Menu" Size="Size.Large" Class="bg-light" Edge="Edge.End" OnClick="@ToggleDrawerRight" />
            </MudAppBar>

            <LeftSideBar open="openLeft"></LeftSideBar>
            <RightSideBar open="openRight"></RightSideBar>

            <MudMainContent Class="row">
                <MudContainer Class="d-flex flex-column align-items-center justify-content-center" Style="height: 90vh;">
                    @Body
                </MudContainer>
            </MudMainContent>

            <MudAppBar Bottom="true" Fixed="true" Style="background-color: rgba(0,0,0,0.7)" Elevation="1">
                <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" />
                <MudSpacer />
                <MudIconButton Icon="@Icons.Material.Filled.FavoriteBorder" Color="Color.Inherit" Edge="Edge.End" />
                <MudIconButton Icon="@Icons.Material.Filled.MoreVert" Color="Color.Inherit" Edge="Edge.End" />
            </MudAppBar>
        </MudLayout>
    </Authorized>
    <NotAuthorized>
        <RedirectToLogin></RedirectToLogin>
    </NotAuthorized>
</AuthorizeView>

@code{

    public EmpireDetailsDto Empire { get; set; }

    protected async override Task OnInitializedAsync()
    {
        await State.InitializeAsync(uriHelper, HttpClientFactory);
    }

    bool openLeft = false;

    void ToggleDrawerLeft()
    {
        openLeft = !openLeft;
    }

    bool openRight = false;

    void ToggleDrawerRight()
    {
        openRight = !openRight;
    }
}